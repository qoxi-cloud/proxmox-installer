# Fail2Ban jail configuration for Proxmox VE 8+
# Generated by Proxmox Hetzner Installer
# Based on: https://pve.proxmox.com/wiki/Fail2ban

[DEFAULT]
# Ban duration: 1 hour (3600 seconds)
bantime = 1h

# Time window for counting failures: 1 day
# (brute-force attacks often try once every few minutes)
findtime = 1d

# Number of failures before ban
maxretry = 5

# Action to take: ban IP using iptables
banaction = iptables-multiport

# Incremental ban times (1h -> 1d -> 2d -> 4d -> ...)
bantime.increment = true
bantime.factor = 24
bantime.maxtime = 30d

# Ignore localhost and private networks
ignoreip = 127.0.0.1/8 ::1 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16

# Backend for log monitoring (systemd for Debian 12+)
backend = systemd

[sshd]
enabled = true
port = ssh
filter = sshd
maxretry = 3
findtime = 1d
bantime = 1h

[proxmox]
enabled = true
port = https,http,8006
filter = proxmox
backend = systemd
maxretry = 3
findtime = 1d
bantime = 2h
